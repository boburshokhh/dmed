# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–¥–≤–∏–≥–∞ PIN-–∫–æ–¥–∞ –∏ QR-–∫–æ–¥–∞ –ø—Ä–∞–≤–µ–µ

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞

–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ margin —è—á–µ–µ–∫ (`-300 twips`) –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏ –≤ LibreOffice/Word, —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ —Å–¥–≤–∏–≥–∞–ª–∏—Å—å –ø—Ä–∞–≤–µ–µ.

## üîß –†–µ—à–µ–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω **–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent —á–µ—Ä–µ–∑ XML** –¥–ª—è –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤ –≤–º–µ—Å—Ç–æ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ margin —è—á–µ–µ–∫.

---

## üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –£–±—Ä–∞–Ω—ã –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ right margin —è—á–µ–µ–∫

**–ë—ã–ª–æ:**
```python
right_margin.set(qn('w:w'), '-300')  # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π margin —è—á–µ–π–∫–∏
```

**–°—Ç–∞–ª–æ:**
```python
right_margin.set(qn('w:w'), '0')  # –ù—É–ª–µ–≤–æ–π margin —è—á–µ–π–∫–∏
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent —á–µ—Ä–µ–∑ XML –¥–ª—è –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤

**–ë—ã–ª–æ:**
```python
para_pin_format.right_indent = Pt(0)  # –ù—É–ª–µ–≤–æ–π –æ—Ç—Å—Ç—É–ø
```

**–°—Ç–∞–ª–æ:**
```python
para_pin_format.right_indent = Pt(0)  # –°–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤ 0
# –ó–∞—Ç–µ–º —á–µ—Ä–µ–∑ XML —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent
from docx.oxml.ns import qn
from docx.oxml import OxmlElement
p_pr = para_pin._element.get_or_add_pPr()
old_ind = p_pr.find(qn('w:ind'))
if old_ind is not None:
    p_pr.remove(old_ind)
ind = OxmlElement('w:ind')
ind.set(qn('w:right'), '-300')  # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø ~20px
p_pr.append(ind)
```

### 3. –ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ 4 –º–µ—Å—Ç–∞—Ö:
- ‚úÖ –û–±—ã—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ - —è—á–µ–π–∫–∞ PIN (—Ñ—É–Ω–∫—Ü–∏—è `create_pin_qr_table`)
- ‚úÖ –û–±—ã—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ - —è—á–µ–π–∫–∞ QR (—Ñ—É–Ω–∫—Ü–∏—è `create_pin_qr_table`)
- ‚úÖ –í–ª–æ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ - —è—á–µ–π–∫–∞ PIN (—Ñ—É–Ω–∫—Ü–∏—è `replace_qr_placeholder`)
- ‚úÖ –í–ª–æ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ - —è—á–µ–π–∫–∞ QR (—Ñ—É–Ω–∫—Ü–∏—è `replace_qr_placeholder`)

---

## üéØ –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ margin —è—á–µ–µ–∫** –º–æ–≥—É—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö LibreOffice/Word
2. **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞** —á–µ—Ä–µ–∑ XML —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–µ–µ
3. **XML –Ω–∞–ø—Ä—è–º—É—é** –ø–æ–∑–≤–æ–ª—è–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ python-docx –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ API

---

## üìä –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ

### –î–æ (–Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ):
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                           2653 [QR] ‚îÇ  ‚Üê –ù–µ —Å–¥–≤–∏–≥–∞–ª–æ—Å—å (margin –Ω–µ —Ä–∞–±–æ—Ç–∞–ª)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Å–ª–µ (—Ä–∞–±–æ—Ç–∞–µ—Ç):
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        2653 [QR]   ‚îÇ  ‚Üê –°–¥–≤–∏–Ω—É—Ç–æ –ø—Ä–∞–≤–µ–µ –Ω–∞ ~20px (right_indent —Ä–∞–±–æ—Ç–∞–µ—Ç)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü:
- **20px** ‚âà **15pt** ‚âà **300 twips**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **-300 twips** (—Ç–æ—á–Ω—ã–µ 20px)

### –ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã:
1. –ü–∞—Ä–∞–≥—Ä–∞—Ñ –≤—ã—Ä–æ–≤–Ω–µ–Ω –ø–æ **RIGHT** (–ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é)
2. **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent** (`-300 twips`) —É–º–µ–Ω—å—à–∞–µ—Ç –æ—Ç—Å—Ç—É–ø —Å–ø—Ä–∞–≤–∞
3. –≠—Ç–æ —Å–¥–≤–∏–≥–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∞–≤–µ–µ –æ—Ç –ø—Ä–∞–≤–æ–≥–æ –∫—Ä–∞—è —è—á–µ–π–∫–∏
4. –û–±–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ (PIN –∏ QR) –ø–æ–ª—É—á–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–¥–≤–∏–≥

### XML —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```xml
<w:p>
  <w:pPr>
    <w:ind w:right="-300"/>  <!-- –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent -->
  </w:pPr>
  <w:r>
    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
  </w:r>
</w:p>
```

---

## üìê –¢–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –û—Ç—Å—Ç—É–ø—ã —è—á–µ–µ–∫ (tcMar):
- **Top**: 0
- **Bottom**: 0
- **Left**: 0 (–¥–ª—è PIN), 20 twips (–¥–ª—è QR - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–ª—è —Å–±–ª–∏–∂–µ–Ω–∏—è)
- **Right**: 0 (–¥–ª—è –æ–±–µ–∏—Ö —è—á–µ–µ–∫)

### –û—Ç—Å—Ç—É–ø—ã –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤ (—á–µ—Ä–µ–∑ XML):
- **space_before**: 0
- **space_after**: 0
- **left_indent**: 0
- **right_indent**: -300 twips (~20px) —á–µ—Ä–µ–∑ XML

### –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ:
- **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ**: RIGHT (–ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é)
- **–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ**: CENTER (–ø–æ —Ü–µ–Ω—Ç—Ä—É)

---

## üîÑ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

1. ‚úÖ –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
2. ‚è≥ –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π `document_generator.py` –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. ‚è≥ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   ```bash
   sudo systemctl restart dmed
   ```
4. ‚è≥ –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
5. ‚è≥ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PIN-–∫–æ–¥ –∏ QR-–∫–æ–¥ —Å–¥–≤–∏–Ω—É—Ç—ã –ø—Ä–∞–≤–µ–µ

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent —á–µ—Ä–µ–∑ XML** —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–µ–µ, —á–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ margin —è—á–µ–µ–∫
2. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ —Å–¥–≤–∏–≥–∞:
   - –£–≤–µ–ª–∏—á—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `-300` –¥–æ `-360` –∏–ª–∏ `-420` (–±–æ–ª—å—à–µ —Å–¥–≤–∏–≥)
   - –ò–ª–∏ —É–º–µ–Ω—å—à–∏—Ç–µ –¥–æ `-240` (–º–µ–Ω—å—à–µ —Å–¥–≤–∏–≥)

3. **–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é LibreOffice/Word
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `-300` –Ω–∞ –¥—Ä—É–≥–æ–µ
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ XML –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏)

---

## üìù –†–µ–∑—é–º–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ margin —è—á–µ–µ–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏  
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent —á–µ—Ä–µ–∑ XML –¥–ª—è –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤  
**–ü—Ä–∏–º–µ–Ω–µ–Ω–æ –∫:** –Ø—á–µ–π–∫–∏ PIN-–∫–æ–¥–∞ –∏ QR-–∫–æ–¥–∞ –≤ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û–±–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–¥–≤–∏–Ω—É—Ç—ã –ø—Ä–∞–≤–µ–µ –æ—Ç –ø—Ä–∞–≤–æ–≥–æ –∫—Ä–∞—è —è—á–µ–π–∫–∏ –Ω–∞ ~20px ‚úÖ

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π PIN-–∫–æ–¥ –∏ QR-–∫–æ–¥ –±—É–¥—É—Ç —Å–¥–≤–∏–Ω—É—Ç—ã –ø—Ä–∞–≤–µ–µ –æ—Ç –ø—Ä–∞–≤–æ–≥–æ –∫—Ä–∞—è —è—á–µ–π–∫–∏ –∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –≤–º–µ—Å—Ç–µ!

