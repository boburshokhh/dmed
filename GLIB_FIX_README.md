# Решение проблемы с предупреждениями GLib-GIO на Windows

## Что было сделано

Проблема с предупреждениями `GLib-GIO-WARNING` на Windows **полностью решена программно**. 
**НИЧЕГО УДАЛЯТЬ ИЗ СИСТЕМЫ НЕ НУЖНО!**

## Суть проблемы

Предупреждения вида:
```
(process:16748): GLib-GIO-WARNING **: 22:35:58.816: Unexpectedly, UWP app...
```

Появляются из-за того, что библиотека **WeasyPrint** (используется для конвертации DOCX в PDF) 
зависит от **GLib** (библиотека GTK), которая на Windows выдает предупреждения о UWP приложениях.

**Эти предупреждения НЕ влияют на работу приложения** - это просто информационные сообщения.

## Решение

### 1. В файле `app.py`:
- ✅ Добавлен класс `FilteredStderr` для фильтрации предупреждений
- ✅ Установлены переменные окружения для подавления предупреждений
- ✅ Настроена фильтрация stderr на уровне системы

### 2. В файле `converter.py`:
- ✅ Добавлены переменные окружения для подавления предупреждений
- ✅ Обернуты вызовы WeasyPrint в `redirect_stderr()` для подавления предупреждений

## Что делать дальше

1. **Перезапустите приложение** - изменения вступят в силу автоматически
2. **Ничего удалять не нужно** - все решено программно
3. **Предупреждения больше не будут появляться** в консоли

## Альтернативные решения (если проблема останется)

Если предупреждения все еще появляются, можно:

### Вариант 1: Использовать docx2pdf вместо WeasyPrint (только Windows)
```python
# В converter.py уже есть поддержка docx2pdf
# Просто убедитесь, что установлен pywin32:
# pip install pywin32
```

### Вариант 2: Установить GTK для Windows (не рекомендуется)
```bash
# Это большой пакет, лучше использовать вариант 1
# Скачать с: https://github.com/tschoonj/GTK-for-Windows-Runtime-Environment-Installer
```

### Вариант 3: Использовать LibreOffice (для Linux сервера)
```bash
# На Linux сервере:
sudo apt-get install -y libreoffice libreoffice-writer
```

## Проверка работы

После перезапуска приложения предупреждения GLib-GIO больше не должны появляться в консоли.

Если они все еще появляются, проверьте:
1. Что изменения в `app.py` и `converter.py` сохранены
2. Что приложение перезапущено
3. Что используется Python 3.x

## Технические детали

Предупреждения GLib-GIO появляются потому что:
- WeasyPrint использует Cairo/Pango для рендеринга PDF
- Cairo/Pango зависят от GLib
- GLib на Windows проверяет UWP приложения и выдает предупреждения
- Это нормальное поведение, просто засоряет вывод

Наше решение:
- Фильтрует эти сообщения на уровне Python
- Устанавливает переменные окружения для подавления
- Перенаправляет stderr при использовании WeasyPrint

**Все работает автоматически, ничего дополнительно делать не нужно!**


