# –£–±–∏—Ä–∞–Ω–∏–µ –æ—Ç—Å—Ç—É–ø–æ–≤ –º–µ–∂–¥—É PIN-–∫–æ–¥–æ–º –∏ QR-–∫–æ–¥–æ–º

## ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞

–ú–µ–∂–¥—É PIN-–∫–æ–¥–æ–º –∏ QR-–∫–æ–¥–æ–º –≤—Å–µ –µ—â–µ –±—ã–ª–∏ –æ—Ç—Å—Ç—É–ø—ã, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ margin —è—á–µ–µ–∫ –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ 0.

## üîß –†–µ—à–µ–Ω–∏–µ

1. **–£–±—Ä–∞–Ω –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è PIN-–∫–æ–¥–∞** - —á—Ç–æ–±—ã –æ–Ω –±—ã–ª –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–æ –∫ QR-–∫–æ–¥—É
2. **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω cell spacing —Ç–∞–±–ª–∏—Ü—ã –≤ 0** - —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—Å—Ç—É–ø—ã –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏

---

## üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –£–±—Ä–∞–Ω –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è PIN-–∫–æ–¥–∞

**–ë—ã–ª–æ:**
```python
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent —á–µ—Ä–µ–∑ XML –¥–ª—è —Å–¥–≤–∏–≥–∞ –≤–ø—Ä–∞–≤–æ
ind = OxmlElement('w:ind')
ind.set(qn('w:right'), '-300')  # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø ~20px
p_pr.append(ind)
```

**–°—Ç–∞–ª–æ:**
```python
# –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è PIN-–∫–æ–¥–∞, —á—Ç–æ–±—ã –æ–Ω –±—ã–ª –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–æ –∫ QR-–∫–æ–¥—É
para_pin_format.right_indent = Pt(0)
```

**–ü—Ä–∏—á–∏–Ω–∞:** 
- –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent —Å–æ–∑–¥–∞–≤–∞–ª –≤–∏–∑—É–∞–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É PIN –∏ QR
- –£–±—Ä–∞–≤ –µ–≥–æ, PIN-–∫–æ–¥ –±—É–¥–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–æ –∫ QR-–∫–æ–¥—É

### 2. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω cell spacing —Ç–∞–±–ª–∏—Ü—ã –≤ 0

**–ë—ã–ª–æ:**
```python
table = doc.add_table(rows=1, cols=2)
table.style = None
# Cell spacing –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```

**–°—Ç–∞–ª–æ:**
```python
table = doc.add_table(rows=1, cols=2)
table.style = None
# –£–±–∏—Ä–∞–µ–º spacing –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏ —Ç–∞–±–ª–∏—Ü—ã —á–µ—Ä–µ–∑ XML
tbl_pr = table._element.tblPr
if tbl_pr is None:
    tbl_pr = OxmlElement('w:tblPr')
    table._element.insert(0, tbl_pr)
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º cell spacing –≤ 0
tbl_cell_spacing = OxmlElement('w:tblCellSpacing')
tbl_cell_spacing.set(qn('w:w'), '0')
tbl_cell_spacing.set(qn('w:type'), 'dxa')
# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π cell spacing –µ—Å–ª–∏ –µ—Å—Ç—å
old_cell_spacing = tbl_pr.find(qn('w:tblCellSpacing'))
if old_cell_spacing is not None:
    tbl_pr.remove(old_cell_spacing)
tbl_pr.append(tbl_cell_spacing)
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–æ –∫:**
- ‚úÖ –û–±—ã—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (—Ñ—É–Ω–∫—Ü–∏—è `create_pin_qr_table`)
- ‚úÖ –í–ª–æ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (—Ñ—É–Ω–∫—Ü–∏—è `replace_qr_placeholder`)

---

## üìä –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ

### –î–æ (–±—ã–ª–∏ –æ—Ç—Å—Ç—É–ø—ã):
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           2653    [QR]             ‚îÇ  ‚Üê –û—Ç—Å—Ç—É–ø –º–µ–∂–¥—É PIN –∏ QR
‚îÇ                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è PIN: -300 twips
Cell spacing: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

### –ü–æ—Å–ª–µ (–±–µ–∑ –æ—Ç—Å—Ç—É–ø–æ–≤):
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          2653[QR]                  ‚îÇ  ‚Üê –ù–µ—Ç –æ—Ç—Å—Ç—É–ø–∞ –º–µ–∂–¥—É PIN –∏ QR
‚îÇ                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è PIN: 0 (—É–±—Ä–∞–Ω)
Cell spacing: 0
```

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:

‚úÖ **PIN-–∫–æ–¥ –∏ QR-–∫–æ–¥ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–æ** - –Ω–µ—Ç –æ—Ç—Å—Ç—É–ø–æ–≤ –º–µ–∂–¥—É –Ω–∏–º–∏  
‚úÖ **–£–±—Ä–∞–Ω –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è PIN-–∫–æ–¥–∞** - –æ–Ω –±–æ–ª—å—à–µ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –æ—Ç—Å—Ç—É–ø  
‚úÖ **Cell spacing —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ 0** - –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—Å—Ç—É–ø–æ–≤ –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏  
‚úÖ **QR-–∫–æ–¥ –≤—Å–µ –µ—â–µ —Å–¥–≤–∏–Ω—É—Ç –≤–ø—Ä–∞–≤–æ** - –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è QR-–∫–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω

---

## üìê –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –û—Ç—Å—Ç—É–ø—ã —è—á–µ–µ–∫ (tcMar):
- **PIN**: Top=0, Bottom=0, Left=0, **Right=0** (–ø—Ä–∏–∂–∞—Ç–æ –∫ QR-–∫–æ–¥—É)
- **QR**: Top=0, Bottom=0, **Left=0** (–ø—Ä–∏–∂–∞—Ç–æ –∫ PIN-–∫–æ–¥—É), Right=0

### –û—Ç—Å—Ç—É–ø—ã –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤:
- **PIN**: space_before=0, space_after=0, left_indent=0, **right_indent=0** (—É–±—Ä–∞–Ω –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π)
- **QR**: space_before=0, space_after=0, left_indent=0, right_indent=0 (—á–µ—Ä–µ–∑ XML: -360 twips –¥–ª—è —Å–¥–≤–∏–≥–∞ –≤–ø—Ä–∞–≤–æ)

### Cell spacing —Ç–∞–±–ª–∏—Ü—ã:
- **–û–±—ã—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞**: 0
- **–í–ª–æ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞**: 0

---

## üîÑ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

1. ‚úÖ –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
2. ‚è≥ –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π `document_generator.py` –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. ‚è≥ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   ```bash
   sudo systemctl restart dmed
   ```
4. ‚è≥ –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç
5. ‚è≥ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ PIN-–∫–æ–¥ –∏ QR-–∫–æ–¥ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É (–Ω–µ—Ç –æ—Ç—Å—Ç—É–ø–æ–≤)

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è QR-–∫–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω** - QR-–∫–æ–¥ –≤—Å–µ –µ—â–µ —Å–¥–≤–∏–Ω—É—Ç –≤–ø—Ä–∞–≤–æ
2. **–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è PIN-–∫–æ–¥–∞ —É–±—Ä–∞–Ω** - PIN-–∫–æ–¥ –±–æ–ª—å—à–µ –Ω–µ —Å–¥–≤–∏–Ω—É—Ç –≤–ø—Ä–∞–≤–æ, –æ–Ω –ø—Ä–∏–∂–∞—Ç –∫ QR-–∫–æ–¥—É
3. **Cell spacing —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ 0** - –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—Å—Ç—É–ø–æ–≤ –º–µ–∂–¥—É —è—á–µ–π–∫–∞–º–∏ —Ç–∞–±–ª–∏—Ü—ã

4. **–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –æ—Ç—Å—Ç—É–ø –º–µ–∂–¥—É PIN –∏ QR:**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ left margin —è—á–µ–π–∫–∏ QR –≤ `10 twips` –∏–ª–∏ `15 twips` (–≤–º–µ—Å—Ç–æ 0)
   - –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ right margin —è—á–µ–π–∫–∏ PIN –≤ `10 twips` –∏–ª–∏ `15 twips` (–≤–º–µ—Å—Ç–æ 0)

5. **–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é LibreOffice/Word
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ XML –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏)
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç—Å—Ç—É–ø–æ–≤

---

## üìù –†–µ–∑—é–º–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ–∂–¥—É PIN-–∫–æ–¥–æ–º –∏ QR-–∫–æ–¥–æ–º –±—ã–ª–∏ –æ—Ç—Å—Ç—É–ø—ã  
**–†–µ—à–µ–Ω–∏–µ 1:** –£–±—Ä–∞–Ω –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π right_indent –¥–ª—è PIN-–∫–æ–¥–∞  
**–†–µ—à–µ–Ω–∏–µ 2:** –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω cell spacing —Ç–∞–±–ª–∏—Ü—ã –≤ 0  

**–ü—Ä–∏–º–µ–Ω–µ–Ω–æ –∫:** –û–±—ã—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏ –≤–ª–æ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PIN-–∫–æ–¥ –∏ QR-–∫–æ–¥ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É –±–µ–∑ –æ—Ç—Å—Ç—É–ø–æ–≤ ‚úÖ

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π PIN-–∫–æ–¥ –∏ QR-–∫–æ–¥ –±—É–¥—É—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É –±–µ–∑ –æ—Ç—Å—Ç—É–ø–æ–≤!

